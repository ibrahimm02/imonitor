{% extends "base.html" %} {% block title %}iMonitor - EC2{% endblock %} {% block
nav_ec2 %}active{% endblock %} {% block navTitle %}EC2{% endblock %} {% block
content %} {% with messages = get_flashed_messages() %} {% if messages %}
<div class="alert alert-success" role="alert">
  {% for message in messages %} {{ message }}<br />
  {% endfor %}
</div>
{% endif %} {% endwith %}

<div class="container">
  <div class="row">
    <div class="col-sm-3">
      <div class="card border-0 shadow-sm mb-4 h-80">
        <div class="card-body m-0" style="padding: 10px 5px 0px 10px;">
          <h5 class="card-title text-center">Instances</h5>
            <table class="table table-borderless">
              <tbody">

                {% for st in ec2_states%}
                <tr>
                  <td class="text-capitalize" style="padding: 2px;">
                    <h6>
                    {{st.state}}
                    </h6>
                  </td>
                  <td class="text-capitalize" style="padding: 2px;">
                    <h6>
                    {{st.value}}
                  </h6>
                  </td>
                </tr>
                {% endfor %}

              </tbody>
            </table>
         </div>
      </div>
    </div>
    <!-- <div class="col-sm-3" style="margin: 12px 0 12px 0">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title">Total Instances</h5>
          <h1 class="display-4">{{ total_instances }}</h1>
        </div>
      </div>
    </div> -->
    <div class="col-sm-3">
      <div class="card text-center border-0 shadow-sm mb-4 h-80">
        <div class="card-body">
          <h5 class="card-title">Minimum Utilization</h5>
          {% for m in ec2_metrics: %}
          <h1 class="display-6">{{m.last_min}}%</h1>
          {% endfor %}
        </div>
      </div>
    </div>
    <div class="col-sm-3">
      <div class="card text-center border-0 shadow-sm mb-4 h-80">
        <div class="card-body">
          <h5 class="card-title">Maximum Utilization</h5>
          {% for m in ec2_metrics: %}
          <h1 class="display-6">{{m.last_max}}%</h1>
          {% endfor %}
        </div>
      </div>
    </div>
    <div class="col-sm-3">
      <div class="card text-center border-0 shadow-sm mb-4 h-80">
        <div class="card-body">
          <h5 class="card-title">Average Utilization</h5>
          {% for m in ec2_metrics: %}
          <h1 class="display-6">{{m.last_avg}}%</h1>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>

<!-- {{instances}} -->

<div class="cointainer">
  <div class="row row-cols-1 row-cols-md-3">
    <div class="col-sm-3">
      <div class="card border-0 shadow-sm mb-4 px-1">
        <img
          src="data:image/png;base64,{{ec2_CPUUtilization}}"
          alt="CPUUtilization Graph"
        />
      </div>
    </div>
    <div class="col-sm-3">
      <div class="card border-0 shadow-sm mb-4 px-1">
        <img src="data:image/png;base64,{{ec2_DiskReadOps}}" alt="DiskReadOps Graph" />
      </div>
    </div>
    <div class="col-sm-3">
      <div class="card border-0 shadow-sm mb-4 px-1">
        <img src="data:image/png;base64,{{ec2_DiskWriteOps}}" alt="DiskWriteOps Graph" />
      </div>
    </div>
    <div class="col-sm-3">
      <div class="card border-0 shadow-sm mb-4 px-1">
        <img src="data:image/png;base64,{{ec2_NetworkIn}}" alt="NetworkIn Graph" />
      </div>
    </div>
    <div class="col-sm-3">
      <div class="card border-0 shadow-sm mb-4 px-1">
        <img src="data:image/png;base64,{{ec2_NetworkOut}}" alt="NetworkOut Graph" />
      </div>
    </div>
    <div class="col-sm-3">
      <div class="card border-0 shadow-sm mb-4 px-1">
        <img
          src="data:image/png;base64,{{ec2_CPUCreditUsage}}"
          alt="CPUCreditUsage Graph"
        />
      </div>
    </div>
    <div class="col-sm-3">
      <div class="card border-0 shadow-sm mb-4 px-1">
        <img
          src="data:image/png;base64,{{ec2_CPUCreditBalance}}"
          alt="CPUCreditBalance Graph"
        />
      </div>
    </div>
    <div class="col-sm-3">
      <div class="card border-0 shadow-sm mb-4 px-1">
        <img
          src="data:image/png;base64,{{ec2_DiskReadBytes}}"
          alt="DiskReadBytes Graph"
        />
      </div>
    </div>
    <div class="col-sm-3">
      <div class="card border-0 shadow-sm mb-4 px-1">
        <img
          src="data:image/png;base64,{{ec2_DiskWriteBytes}}"
          alt="DiskWriteBytes Graph"
        />
      </div>
    </div>
  </div>
</div>

{{info}}

<div class="card text-center border-0 shadow-sm mb-4">
  <div class="card-body p-0">
    <div class="table-responsive">
      <table
        class="table table-nowrap mb-0 rounded"
        style="vertical-align: middle"
      >
        <thead class="table-light">
          <th class="border-0 rounded-start">Instance Name</th>
          <th class="border-0">Instance Id</th>
          <th class="border-0">State</th>
          <th class="border-0">Type</th>
          <th class="border-0">Public IPv4</th>
          <th class="border-0">AMI Id</th>
          <th class="border-0">Launch time</th>
          <th class="border-0 rounded-end">Availability Zone</th>  
        </thead>

        {%for instance in instances:%}
        <tr>
          <td>{{instance.tags[0]['Value']}}</td>                
          <td>{{instance.id}}</td>

          <td>
            <div class="btn-group dropend">
              <button
                type="button"
                class="btn btn-outline-info dropdown-toggle btn-sm"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                {{instance.state['Name']}}
              </button>
              <ul class="dropdown-menu">
                <li>
                  <form action="{{ url_for('start_instance')}}" method="POST">
                    <input
                      type="hidden"
                      name="instance"
                      value="{{ instance.id }}"
                    />
                    <button type="submit" class="dropdown-item">Start</button>
                  </form>
                </li>
                <li>
                  <form action="{{ url_for('stop_instance')}}" method="POST">
                    <input
                      type="hidden"
                      name="instance"
                      value="{{ instance.id }}"
                    />
                    <button type="submit" class="dropdown-item">Stop</button>
                  </form>
                </li>
              </ul>
            </div>
          </td>

          <td>{{instance.instance_type}}</td>
          <td>{{instance.public_ip_address}}</td>
          <td>{{instance.image.id}}</td>
          <td>{{instance.launch_time.strftime("%d-%m-%Y, %H:%M:%S")}}</td>
          <td>{{instance.placement['AvailabilityZone']}}</td>
        </tr>
        {%endfor%}
      </table>
    </div>
  </div>
</div>

{% for v in ec2_states: %} {{v.value}} {% endfor %}

<canvas id="myChart" width="600" height="400"></canvas>

<script>
  // Global parameters:
  // do not resize the chart canvas when its container does (keep at 600x400px)
  Chart.defaults.global.responsive = false;

  // define the chart data
  var chartData = {
    labels: ["Chrome", "IE", "FireFox", "Safari", "Opera", "Navigator"],
    datasets: [
      {
        data: [50, 45, 21, 150, 95, 66],
        backgroundColor: [
          "#f56954",
          "#00a65a",
          "#f39c12",
          "#00c0ef",
          "#3c8dbc",
          "#d2d6de",
        ],
      },
    ],
  };

  // get chart canvas
  var ctx = document.getElementById("myChart").getContext("2d");

  var options = {
    tooltips: {
      enabled: false,
    },
    plugins: {
      labels: [
        {
          render: "label",
          position: "outside",
          fontColor: "#000",
          fontSize: 15,
        },
        {
          render: "percentage",
          fontColor: "#000",
          fontSize: 10,
          position: "border",
        },
      ],
    },
  };

  // create the chart using the chart canvas
  var myChart = new Chart(ctx, {
    type: "pie",
    data: chartData,
    options: options,
  });
</script>

<!-- <h4>dashboard24HoursPerformanceChart - in imonitor fiverr app</h4> -->

<!-- {{ data }}  -->

{% endblock %}
